// main.js (Minimalized for Flask Template Use)

/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * CONGRESS TWITTER NETWORK ANALYTICS DASHBOARD - JAVASCRIPT
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * * Minimal utility file for Flask-templated application.
 * All D3 chart drawing and data processing logic has been removed.
 * Only placeholder or auxiliary functions remain.
 */

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 1. DUMMY DATA STRUCTURE (Replace with Flask Context in a real app)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let statsData = {
    num_nodes: 475,
    num_edges: 13289,
    num_communities: 4,
    modularity: 0.3998,
    density: 0.057,
    avg_clustering: 0.25
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 2. TOOLTIP SYSTEM (Retained as it's general D3 utility)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function showTooltip(event, html) {
    const tooltip = d3.select('#tooltip');
    tooltip.html(html);
    tooltip.style('opacity', 1);
    
    const tooltipNode = tooltip.node();
    const tooltipWidth = tooltipNode.offsetWidth;
    const tooltipHeight = tooltipNode.offsetHeight;
    
    let left = event.clientX + 15;
    let top = event.clientY - tooltipHeight - 15;
    
    if (left + tooltipWidth > window.innerWidth) {
        left = event.clientX - tooltipWidth - 15;
    }
    
    if (top < 0) {
        top = event.clientY + 15;
    }
    
    if (top + tooltipHeight > window.innerHeight) {
        top = window.innerHeight - tooltipHeight - 10;
    }
    
    if (left < 0) {
        left = 10;
    }
    
    tooltip
        .style('left', left + 'px')
        .style('top', top + 'px')
        .style('pointer-events', 'none');
}

function hideTooltip() {
    d3.select('#tooltip').style('opacity', 0);
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 3. AUXILIARY FUNCTIONS (Minimal version of downloadData)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function downloadData(format) {
    // NOTE: In a production Flask app, this would trigger an endpoint
    // to generate the data, but for static structure, we use the local statsData
    
    const data = {
        stats: statsData,
        // Other data structures (like networkData, communityData) are omitted for brevity
        // and because they are assumed to be generated by Flask
    };
    
    let content, mimeType, extension;
    
    if (format === 'json') {
        content = JSON.stringify(data, null, 2);
        mimeType = 'application/json';
        extension = 'json';
    } else {
        let csvContent = 'Metric,Value\n';
        csvContent += `Total Nodes,${statsData.num_nodes}\n`;
        csvContent += `Total Edges,${statsData.num_edges}\n`;
        csvContent += `Modularity,${statsData.modularity}\n`;
        csvContent += `Communities,${statsData.num_communities}\n`;
        csvContent += `Density,${statsData.density}\n`;
        csvContent += `Avg Clustering,${statsData.avg_clustering}\n`;
        
        content = csvContent;
        mimeType = 'text/csv';
        extension = 'csv';
    }
    
    const blob = new Blob([content], { type: mimeType });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `congress_network_analysis.${extension}`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    
    console.log(`âœ… Data downloaded in ${format} format`);
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 4. INITIALIZATION (Minimal)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('DOMContentLoaded', async function() {
    console.log('ðŸš€ Congress Network Dashboard ready for Flask templating...');
    
    // In a Flask app, chart rendering functions (drawNetworkGraph, drawCommunityDistribution)
    // would be called here after Flask has loaded the required data into global JS variables.
    
    // Example placeholder:
    // if (window.NETWORK_DATA && window.COMMUNITY_DATA) {
    //     drawNetworkGraph(window.NETWORK_DATA); 
    //     drawCommunityDistribution(window.COMMUNITY_DATA); 
    // }
});

// Make functions globally available if needed
window.showTooltip = showTooltip;
window.hideTooltip = hideTooltip;
window.downloadData = downloadData;